<!doctype html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>外部调用UEditor的多图上传和附件上传</title>
    <script type="text/javascript" src="lib/ueditor/1.4.3/ueditor.config.js"></script>
    <script type="text/javascript" src="lib/ueditor/1.4.3/ueditor.all.js"></script>
    <script type="text/javascript" src="/lib/jquery/1.9.1/jquery.min.js"></script> 
    <style>
        ul{display: inline-block;width: 100%;margin: 0;padding: 0;}
        li{list-style-type: none;margin: 5px;padding: 0;}
        .upload_btn{
            font-size: 14px;
            background: #3bb4f2 none repeat scroll 0 0;
            border-radius: 3px;
            color: #fff;
            cursor: pointer;
            display: inline-block;
            overflow: hidden;
            padding: 4px 12px;
            position: relative;
            text-align: center;
        }
    </style>
</head>
<body>
<h1>外部调用UEditor的多图上传和附件上传示例</h1>
 
<div class="upload_btn" id="img1">多图上传</div>
 
<div class="upload_btn" id="img2">多图上传</div>
<!-- 加载编辑器的容器 -->
 
<!-- 使用ue -->
<script type="text/javascript">
document.write('<textarea id="uploadEditor" style="display: none;"></textarea>');
// 实例化编辑器，这里注意配置项隐藏编辑器并禁用默认的基础功能。
var uploadEditor = UE.getEditor("uploadEditor", {
    isShow: false,
    focus: false,
    enableAutoSave: false,
    autoSyncData: false,
    autoFloatEnabled:false,
    wordCount: false,
    sourceEditor: null,
    scaleEnabled:true,
    toolbars: [["insertimage", "attachment"]]
});
var currId = '';
// 监听多图上传组件的插入动作
uploadEditor.ready(function () {
    uploadEditor.addListener("beforeInsertImage", _beforeInsertImage);
});

// 自定义按钮绑定触发多图上传和上传附件对话框事件
$(function(){
    $(".upload_btn").click(function(){
        currId = $(this).attr("id");
        var dialog = uploadEditor.getDialog("insertimage");
        dialog.title = '多图上传';
        dialog.render();
        dialog.open();
    });
});

// 多图上传动作
function _beforeInsertImage(t, result) {
    if(t == "beforeinsertimage"){
        if($("#ul_"+currId).size() == 0){
            $("#"+currId).after('<ul id="ul_'+currId+'"></ul>');
        }
        var ul = $("#ul_"+currId);
        var imageHtml = '';
        for(var i in result){
            imageHtml += '<li><img src="'+result[i].src+'" alt="'+result[i].alt+'" height="150"></li>';
        }
        ul.append(imageHtml);
    }
}
</script>
</body>
</html>